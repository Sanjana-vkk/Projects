---
title: "Final Project Report"
author: Saumyaa Sinha, Andrew Harris, Sanjana Kuchipudi
date: "Due: 05/04/2022"
output: html_notebook
---

The three datasets are available in the repo


links to the data sets below: 
https://www.kaggle.com/code/paultimothymooney/2020-usa-election-vote-percentages-by-state/data?select=democratic_vs_republican_votes_by_usa_state_2020.csv
Shown above is the data set for the democratic vs republican votes data by the US state in 2020. This data is very useful to see the voting percentages in the 2020 presidential election. The variables include the US state and the number of republicans and democrats for each state. Includes additional columns for the US state and the US state code. The last variable is the percent democrat for each of the 50 US states. 

https://www.kaggle.com/datasets/benhamner/2016-us-election?select=county_facts.csv
The 2016 US election data shows the county demographics data for US counties from the US census. This data set has 54 total variables including the fips code, the area name, state abbreviation, population estimates for several years such as 2010 and 2014. It also included the population percent for several age ranges. 

https://www.kff.org/other/state-indicator/distribution-by-age/?currentTimeframe=0&sortModel=%7B%22colId%22:%22Location%22,%22sort%22:%22asc%22%7D
This data set shows the population distributions by age in the US states. It includes the percentages for  six age ranges for all 50 states. This data is based on the Census Bureauâ€™s American Community Survey (ACS). 


Research question: 
How does the age in percent of population affect the voting patterns in the US?


Explains why the topic is important: 
Voter turnout is low in the United states when compared with other similar countries around the world. We want to investigate this turnout, specifically when looking at different age groups, to see if it provides any insight into why our turnout is so low. When looking at different age groups, we can see if efforts being done to improve the voting of those groups are effective. With this being done, it could give some ideas into our problems and help those trying to solve them. 

Wrangling:
See how percent of population (age) affects voting patterns
Average out population percents in the demographic table (county averaged to represent state)
Drop a column in the voting table (state code)
join table for better comparison
User defined function if statements check in percent


```{r}
demographics <- read.csv(file.choose("demographics.csv"))
voting <- read.csv(file.choose("voting.csv"))
```

```{r}
raw_data <- read.csv(file.choose("raw_data.csv"))
raw_data
```



```{r}
library(dplyr)
library(tidyverse)
library(ggplot2)
install.packages("usmap")
library(usmap)
```


```{r}
glimpse(demographics)
```



```{r}
glimpse(voting)
```

```{r}
head(voting)
```


```{r}
newDem <-demographics %>%
  filter(!grepl(".", state_abbreviation, ignore.case = TRUE))
updated <-select(newDem, c('area_name','PST045214','PST120214','AGE135214','AGE295214','AGE775214'))
newDem
```



```{r}
finalTable <-
  updated %>%
   left_join(voting, by = c("area_name" ="state"))
finalTable
``` 

```{r}
FinalTable2 <-
  finalTable %>%
  left_join(raw_data, by = c( "area_name" = "Location"))
FinalTable2
```




### attempt at doing mulitple bars per state 
```{r}
finalGraph <-
  FinalTable2 %>%
   ggplot(aes(x = usa_state, y = percent_democrat,fill = "" )) +
         geom_col() + 
         scale_fill_manual(breaks = c("Adults.19.25", "adults.26.34", "Adults.35.54", "Adults.55.64" ))

```

```{r}
finalGraph
```


```{r}
  FinalTable2 %>%
    ggplot(aes(x = usa_state, y= percent_democrat, fill = usa_state)) +
    geom_bar(stat = "identity")  +
    geom_col(width = 3) +
    labs (x = "") 
```

```{r}
 FinalTable2 %>%
    ggplot(aes(x = usa_state, y= percent_democrat)) +
    geom_bar(stat = "identity")  +
    geom_col(width = 3) +
    labs (x = "") + coord_cartesian(xlim = c(0, 60), ylim = c(0, 75))
```
```{r}
  FinalTable2 %>%
    ggplot(aes(x = Adults.19.25, y= percent_democrat, color = usa_state)) +
    geom_point(stat = "identity") +
    labs (x = "") 
```
```{r}
FinalTable2 %>%
    ggplot(aes(x = X65., y= percent_democrat, color = usa_state)) +
    geom_point(stat = "identity") +
    labs (x = "") 
```

```{r}
plot_usmap(data = FinalTable2, values = "percent_democrat", color = "red") + 
  scale_fill_continuous(name = "Percent of Democrats", label = scales::comma) + 
  theme(legend.position = "right")

```

